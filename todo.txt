1. SAP: ancstor and length refactor - modularize
2. SAP: ancestor and length cache values
3.